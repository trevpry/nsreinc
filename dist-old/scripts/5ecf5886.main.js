"use strict";function initDialog(a,b,c){return console.log(b),dialog=a.dialog({autoOpen:!1,height:void 0!=b?b:200,width:void 0!=c?c:350,modal:!0,close:function(){$(this).dialog("close")}})}function inputIsValid(a){var b=!0,c=[];return a.email.match(/^[\w\-\.]+@([\w\-]+\.)+[\w\-]{2,4}$/i)||(b=!1,c.push("Please enter a valid email address")),(!a.password.match(/[\w\W]{5,}/gi)||a.password.match(/\s/g))&&(b=!1,c.push("Please enter valid password")),displayErrors(c),console.log(c),b}function toggleVisible(a){formVisible=!formVisible,a.css(formVisible?{display:"inline-block"}:{display:"none"})}function propertyInputIsValid(a){for(var b=!0,c=[],d=0;d<a.length;d++)"listing_price"===a[d].name&&isNaN(a[d].value)&&(b=!1,c.push("Please enter a valid number"));return displayErrors(c),b}function modProperty(a,b,c){return a.attr("id",b.propertyData.id),a.find(".property-image img").attr("src",c),a.find(".property-status .detail").text(b.propertyData.status),a.find(".property-price .detail").text(b.propertyData.price),a.find(".property-type .detail").text(b.propertyData.property_type),a.find(".property-location .detail").text(b.propertyData.location),a.find(".highlights-list .detail").html(b.propertyData.highlights),a}function addProperty(a){toggleVisible($("form.add-property"));var b=$(".property").last().clone();b.removeClass("hidden");var c="images/properties/property-"+a.propertyData.id+".jpeg",d=modProperty(b,a,c);d.prependTo($(".property-list"))}function updateProperty(a){console.log(a.propertyData),toggleVisible($("form.edit-property"));var b=$(".property-list #"+a.propertyData.id),c="images/properties/property-"+a.propertyData.id+".jpeg";console.log(modProperty(b,a,c).attr("id"))}function userInputIsValid(a){var b=!0,c=[];return a.first_name.match(/[\w\s]+/gi)&&a.last_name.match(/[\w\s]+/gi)||(b=!1,c.push("Please enter a valid name")),a.email.match(/^[\w\-\.]+@([\w\-]+\.)+[\w\-]{2,4}$/i)||(b=!1,c.push("Please enter a valid email address")),!a.password.match(/[\w\W]{5,}/gi)||a.password.match(/\s/g)?(b=!1,c.push("Please enter a valid password")):a.password!==a.password_confirm&&(b=!1,c.push("Your password and password confirmation do not match")),displayErrors(c),b}function modUser(a,b){return a.attr("id",b.userData.id),a.find(".user-name .detail").text(b.userData.first_name+" "+b.userData.last_name),a.find(".email .detail").text(b.userData.email),a}function addUser(a){var b=$(".user").last().clone(),c=modUser(b,a);c.prependTo($(".user-list"))}function updateUser(a){var b=$(".user[user-id="+a.userData.id+"]");modUser(b,a)}var dialog,loggedIn=!1,displayErrors=function(a){$(".validate-tips p").remove();for(var b=0;b<a.length;b++)$(".validate-tips").append("<p>"+a[b]+"</p>")};$(document).on("slideLoaded",function(a){console.log(loggedIn),"editable"===a.message.pageType&&($(".auth").css({visibility:"visible"}),addDialog=initDialog($(".create"),600,400),editDialog=initDialog($(".update"),600,400))}),$(document).ready(function(){function a(){console.log("gallery"),blueimp.Gallery($("#links a"),{container:"#blueimp-gallery-carousel",carousel:!0})}function b(a){$(".ui-dialog").remove(),$.get(a.path,a,function(b){$(".main-content .slide-page").hide("slide",{direction:e,queue:!1},i,function(){$(this).remove()}),$(b).hide().appendTo($(".main-content")).show("slide",{direction:f,queue:!1},i,function(){$.event.trigger({type:"slideLoaded",message:{page:a.name,pageType:h}})})})}var c,d=0,e="right",f="left",g="home",h="standard",i=300,j={home:{name:"home",path:"./partials/slides/home.php"},consultation:{name:"consultation",path:"./partials/slides/consultation.html"},commercial:{name:"commercial",path:"./partials/slides/property/property_index.php"},residential:{name:"residential",path:"./partials/slides/property/property_index.php"},apartments:{name:"apartment",path:"./partials/slides/property/property_index.php"},portfolio:{name:"portfolio",path:"./partials/slides/home.php"},contact:{name:"contact",path:"./partials/slides/contact_us.html"},admin:{name:"admin",path:"./partials/slides/admin.php"}};$(document).on("slideLoaded",function(b){"home"===b.message&&a()}),$(".main-content").load(j.home.path,a),$(document).on("click",".tab",function(){c=$(this).attr("id"),d=$(".active").attr("id"),g=$(this).attr("page"),h=$(this).hasClass("editable")?"editable":"standard",f=c>d?"left":"right",e=c>d?"right":"left",$(".active").removeClass("active"),$(this).addClass("active"),b(j[g])})});var form;$(document).on("slideLoaded",function(a){"contact"===a.message.page&&initDialog($("#dialog-form"))}),$(document).on("click",".login",function(){console.log("clicked"),dialog.dialog("open")}),$(document).on("click",".logout",function(){$.get("./src/controllers/auth/logout.php",function(){}).done(function(a){console.log(a),location.reload()}).fail(function(){})}),$(document).on("submit","#dialog-form form",function(a){a.preventDefault();var b=[],c={email:$("input[name=email]").val(),password:$("input[name=password]").val()};inputIsValid(c)&&$.post("./src/controllers/auth/login.php",c,function(){}).done(function(a){var c=$.parseJSON(a);loggedIn=c.auth,console.log(a),"success"!=c.found&&b.push("The username you entered is not valid"),"success"!==c.found||c.auth||b.push("The password you entered is not valid")}).fail(function(){}).always(function(){b.length>0?displayErrors(b):(dialog.dialog("close"),location.reload())})});var addDialog,editDialog,formVisible=!1,formUrls={create:"./src/controllers/property_create.php",update:"./src/controllers/property_update.php",destroy:"./src/controllers/property_destroy.php"};$(document).ready(function(){$(document).on("click",".add-link",function(){addDialog.dialog("open")}),$(document).on("click",".property #edit",function(){var a=$(this).closest(".property"),b=a.attr("id"),c=a.find(".highlights-list .detail").html().replace("<strong>","||");$(".edit-property #status").val(a.find(".property-status .detail").text()),$(".edit-property #listing-price").val(a.find(".property-price .detail").text().replace(/\$|,/g,"")),$(".edit-property #property-type").val(a.find(".property-type .detail").text()),$(".edit-property #city").val(a.find(".property-location .detail").text()),$(".edit-property #highlights").val(c.replace(/(<([^>]+)>)/gi,"")),$(".edit-property #id").val(b),editDialog.dialog("open")}),$(document).on("click",".property #delete",function(){var a=$(this).closest(".property").attr("id");console.log(a),$.post(formUrls.destroy,{id:a},function(){}).done(function(){$("#"+a).css({display:"none"})}).fail(function(){})}),$(document).on("submit",".property-form",function(a){a.preventDefault();var b=new FormData($(this)[0]),c=$(this).hasClass("add-property")?"create":"update";propertyInputIsValid($(this).serializeArray())&&$.ajax({url:"create"===c?formUrls.create:formUrls.update,type:"POST",data:b,processData:!1,contentType:!1}).done(function(a){var b=$.parseJSON(a);console.log(b),"success"===b.saved&&("create"===c?(addDialog.dialog("close"),console.log("create"),addProperty(b)):(editDialog.dialog("close"),console.log("update"),updateProperty(b)))}).fail(function(){console.log("error")})})});var userElement,userFormUrls={create:"./src/controllers/user/user_create.php",update:"./src/controllers/user/user_update.php",destroy:"./src/controllers/user/user_destroy.php"};$(document).ready(function(){$(document).on("click",".add-link",function(){addDialog.dialog("open")}),$(document).on("click",".user #edit",function(){var a=$(this).closest(".user"),b=a.attr("id");$(".update #first-name").val(a.find(".first-name .detail").text()),$(".update #last-name").val(a.find(".last-name .detail").text()),$(".update #email").val(a.find(".email .detail").text()),$(".update #id").val(b),console.log("clicked"),editDialog.dialog("open")}),$(document).on("click",".user #delete",function(){userElement=$(this).closest(".user");var a=userElement.attr("id");console.log(a),$.post(userFormUrls.destroy,{id:a},function(){}).done(function(a){console.log(a),userElement.css({display:"none"}),console.log(userElement)}).fail(function(){console.log("error")})}),$(document).on("submit",".user-form",function(a){a.preventDefault();var b=$(this).hasClass("create")?"create":"update",c={first_name:$("."+b+" input[name=first_name]").val(),last_name:$("."+b+" input[name=last_name]").val(),email:$("."+b+" input[name=email]").val(),password:$("."+b+" input[name=password]").val(),password_confirm:$("."+b+" input[name=password_confirm]").val(),id:$("."+b+" input[name=id]").val()};userInputIsValid(c)&&$.ajax({url:"create"===b?userFormUrls.create:userFormUrls.update,type:"POST",data:c}).done(function(a){var c=$.parseJSON(a);"success"===c.saved&&("create"===b?(console.log("create"),addDialog.dialog("close"),addUser(c)):(console.log("update"),editDialog.dialog("close"),updateUser(c)))}).fail(function(){console.log("error")})})});